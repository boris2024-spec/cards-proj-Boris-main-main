# Функциональность блокировки пользователей

## Описание изменений

Была добавлена улучшенная функциональность блокировки пользователей в административной панели с использованием специальных API endpoints.

### Основные изменения:

1. **Исправлены API endpoints для блокировки**
   - Используются специальные endpoints: `/users/:id/block` и `/users/:id/unblock`
   - Блокировка автоматически устанавливает `isBusiness: false` на бэкенде

2. **Обновленные файлы:**
   - `src/pages/AdminUsersPage.jsx` - основная логика блокировки в UI
   - `src/users/hooks/useAdmin.js` - хук для административных операций

### API Endpoints:

#### Блокировка пользователя:
```http
PATCH /users/:id/block
Headers: x-auth-token: <admin_token>
```
Ответ: обновленный объект пользователя с `isBlocked: true` и `isBusiness: false`

#### Разблокировка пользователя:
```http
PATCH /users/:id/unblock  
Headers: x-auth-token: <admin_token>
```
Ответ: обновленный объект пользователя с `isBlocked: false`

### Как это работает:

#### В таблице пользователей:
- Кнопка "Block" вызывает функцию `handleUserToggle`
- При блокировке пользователя отправляется `PATCH /users/:id/block`
- При разблокировке отправляется `PATCH /users/:id/unblock`
- Бэкенд автоматически управляет полем `isBusiness`

#### В модальном окне редактирования:
- Добавлен переключатель "Blocked" 
- При сохранении сначала обновляются основные данные через `PUT /users/:id`
- Затем, если изменился статус блокировки, отправляется соответствующий PATCH запрос

### Логика безопасности:
- Только администраторы могут блокировать/разблокировать пользователей
- Заблокированный пользователь автоматически теряет статус бизнес-аккаунта
- При разблокировке статус бизнес-аккаунта можно установить заново вручную
- Все изменения логируются в консоль для отладки

### Тестирование:

#### Автоматическое тестирование:
1. Запустите тестовый скрипт: `test-frontend-block.js`
2. Выполните в консоли браузера: `testFrontendBlockFunctionality()`

#### Ручное тестирование в UI:
1. Авторизуйтесь как администратор
2. Перейдите на страницу "Admin Users" (/admin/users)
3. Найдите пользователя и нажмите кнопку "Block"
4. Проверьте, что статус изменился на "Blocked"
5. Нажмите "Unblock" для разблокировки

### Интерфейс:
- Заблокированные пользователи отображаются с красным чипом "Blocked"
- Активные пользователи отображаются с зеленым чипом "Active"  
- Кнопка блокировки меняет текст с "Block" на "Unblock" и цвет
- Сообщения об успехе/ошибке отображаются в виде уведомлений

### Обработка ошибок:
- При ошибке 404: проверьте правильность API endpoints
- При ошибке 403: проверьте права администратора
- При ошибке сети: проверьте подключение к серверу
