# Функциональность администратора

## Обзор

В приложение добавлена полная функциональность администратора, которая позволяет управлять пользователями и карточками.

## Основные возможности

### 1. Роли пользователей
- **Обычный пользователь** - базовые права
- **Бизнес пользователь** - может создавать карточки
- **Администратор** - полные права управления системой

### 2. Административная панель
- Доступна по маршруту `/admin`
- Статистика системы в реальном времени
- Быстрые ссылки на управление пользователями и карточками

### 3. Управление пользователями (`/admin/users`)
- Просмотр всех пользователей
- Поиск по имени и email
- Блокировка/разблокировка пользователей
- Изменение ролей (бизнес, администратор)
- Удаление пользователей
- Редактирование профилей пользователей

### 4. Управление карточками (`/admin/cards`)
- Просмотр всех карточек
- Поиск и фильтрация
- Блокировка/разблокировка карточек
- Удаление карточек
- Просмотр деталей карточек

## Файлы и компоненты

### Guards (Защита маршрутов)
- `src/guards/AdminRoute.jsx` - Защита админских маршрутов

### Страницы
- `src/pages/AdminDashboardPage.jsx` - Главная панель администратора
- `src/pages/AdminUsersPage.jsx` - Управление пользователями
- `src/pages/AdminCardsPage.jsx` - Управление карточками

### Hooks
- `src/users/hooks/useAdmin.js` - Хук для админских операций

### Компоненты
- `src/components/AdminSetupHelper.jsx` - Помощник для назначения первого админа

### Маршруты
Добавлены новые маршруты в `src/routes/routesDict.js`:
- `/admin` - Главная панель
- `/admin/users` - Управление пользователями
- `/admin/cards` - Управление карточками

## Схемы данных

### Обновленная модель пользователя
```javascript
{
  name: { first, middle, last },
  email,
  phone,
  image: { url, alt },
  address: { street, houseNumber, city, state, country, zip },
  isBusiness: Boolean,
  isAdmin: Boolean,     // НОВОЕ ПОЛЕ
  isBlocked: Boolean,   // Для блокировки пользователей
  createdAt,
  updatedAt
}
```

## API Endpoints (требуются на бэкенде)

### Пользователи
- `GET /users` - Получить всех пользователей (только для админов)
- `PUT /users/:id` - Обновить пользователя (только для админов)
- `PATCH /users/:id` - Частичное обновление пользователя
- `DELETE /users/:id` - Удалить пользователя (только для админов)

### Карточки
- `GET /cards` - Получить все карточки (с возможностью фильтрации)
- `PUT /cards/:id` - Обновить карточку (только для админов)
- `PATCH /cards/:id` - Частичное обновление карточки
- `DELETE /cards/:id` - Удалить карточку (только для админов)

## Безопасность

1. Все админские маршруты защищены компонентом `AdminRoute`
2. Проверка прав доступа осуществляется на основе поля `isAdmin`
3. Токен авторизации передается в заголовках запросов
4. Административные функции недоступны обычным пользователям

## Первоначальная настройка

Для назначения первого администратора:

1. Зарегистрируйте пользователя обычным способом
2. Используйте компонент `AdminSetupHelper` (кнопка в правом нижнем углу)
3. Введите email пользователя, которого нужно сделать администратором
4. После назначения пользователь получит доступ к административной панели

## Использование

### Вход в административную панель
1. Войдите как пользователь с правами администратора
2. В меню навигации появится пункт "Admin Panel"
3. Перейдите в административную панель

### Управление пользователями
1. Перейдите в "Управление пользователями"
2. Используйте поиск для нахождения конкретных пользователей
3. Используйте кнопки действий для управления пользователями

### Управление карточками
1. Перейдите в "Управление карточками"
2. Фильтруйте карточки по статусу
3. Просматривайте детали и управляйте карточками

## Интеграция с бэкендом

Убедитесь, что ваш бэкенд поддерживает:
1. Поле `isAdmin` в модели пользователя
2. Поле `isBlocked` для пользователей и карточек
3. Соответствующие API endpoints для CRUD операций
4. Проверку прав доступа на серверной стороне

## Разработка

Для добавления новых административных функций:
1. Создайте новую страницу в `src/pages/`
2. Добавьте маршрут в `routesDict.js`
3. Защитите маршрут компонентом `AdminRoute`
4. Добавьте соответствующие функции в `useAdmin` хук
5. Обновите навигацию в административной панели
